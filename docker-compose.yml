version: '3.2'

services:
  validator:
    container_name: validator
    image: metronome-validator:latest
    volumes:
      - /usr/src/metronome-validator/node_modules
      - .:/usr/src/metronome-validator
    network_mode: "service:redis"
    environment:
      - REDIS_URL=redis://127.0.0.1:6379/5
      - eth_walletMnemonic=${eth_walletMnemonic}
      - etc_walletMnemonic=${etc_walletMnemonic}
      - qtum_walletMnemonic=${qtum_walletMnemonic}
    depends_on: 
      - redis
    restart: always
  redis:
    image: redis:5.0.3
    container_name: redis
    image: redis
    command: ["redis-server", "--appendonly", "yes"]
    ports:
      - "6379:6379"
    network_mode: host
    restart: always